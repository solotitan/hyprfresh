{"id":"mem-3124842a90773141","information":"Cross-Device Layout Refactoring - Pages Refactored (2026-01-19): Fixed 32 page files including Login, Signup, EmailConfirmed, TermsOfService, PrivacyPolicy, ReportBug, SavedItems, StaffDirectory, Notifications, Settings, PublicProfile, Home, PublicSafetyPage, EventArchive, MovieDetail, PostDetail, and all admin pages. Replaced all min-h-screen with min-h-dvh, removed h-screen/100vh/overflow-hidden, added desktop max-width shells (max-w-screen-xl mx-auto px-4), applied flex scroll pattern with flex-1 overflow-y-auto. Fixed inline styles to use CSS classes with safe area padding.","created_at":"2026-01-19T19:57:35.551Z","tags":"pwa,capacitor,layout,pages,refactor"}
{"id":"mem-465ab71f2b734311","information":"NCPulseDocs Documentation Workflow - How to add new documentation pages:\n\nNCPulseDocs is a separate Git repository at /home/solotitan/github/NCPulseDocs that serves static documentation using Vite.\n\nFile Structure:\n- src/content/ - Source files for editing\n- public/ - Static files served by Vite dev server\n\nWhen Adding New Documentation Pages:\n\n1. Create markdown file in src/content/[category]/filename.md\n   - Use frontmatter: title, description\n   - Internal links use /docs/ prefix\n\n2. Update src/sidebar.js to add navigation item\n   - Add to appropriate section in sidebar array\n   - Format: { title: 'Page Title', path: '/docs/category/filename' }\n\n3. Update src/main.js pathMap object\n   - Maps route to actual markdown file\n   - Add: '/docs/category/filename': '/docs/category/filename.md'\n\n4. Copy markdown file to public/ directory\n   - Vite dev server serves from public/\n   - Copy from src/content/[category]/filename.md to public/docs/[category]/filename.md\n   - This is REQUIRED for dev server to serve the file\n\n5. Build and test\n   - npm run build for production build\n   - npm run dev for local testing\n   - Verify hash routing works: localhost:5174/#category/filename\n\nRouting System:\n- Uses hash-based routing (not URL paths)\n- Sidebar links use href=\"#category/filename\" (not href=\"/docs/category/filename\")\n- main.js loadContent() parses hash, fetches from /docs/category/filename.md\n- pathMap converts /docs/category/filename to actual file path\n\nCommon Pitfalls:\n- Forgetting to add to pathMap → \"Not found\" error in fetch()\n- Using path-based href instead of hash-based → URL mangles to /category/filename#category/filename\n- Forgetting to copy to public/ → 404 error (fetch() can't find file)\n- Not hard refreshing browser after changes → Serves cached old JavaScript","created_at":"2026-01-19T21:33:32.527Z","tags":"NCPulseDocs documentation vite routing workflow"}
{"id":"mem-52d96b49e061db75","information":"Cross-Device Layout Refactoring - Modals (2026-01-19): Fixed src/components/AuthPromptModal.jsx, ImageModal.jsx, DeleteConfirmModal.jsx, MilestoneCelebration.jsx, OfflineStatus.jsx. Added env() safe area padding to all backdrops (p-[env(safe-area-inset-top)] etc), changed backdrop to bg-[#000000]/70 backdrop-blur-sm. Added proper flex layout with max-h-[calc(100dvh-2*env(safe-area-inset-top)-2*env(safe-area-inset-bottom))]. Added flex-1 overflow-y-auto to content areas and flex-shrink-0 to header/footer. Fixed z-index: Modals at z-[100], BottomNav at z-[40], DesktopSidebar at z-[30].","created_at":"2026-01-19T19:57:39.744Z","tags":"pwa,capacitor,layout,modals,safe-areas"}
{"id":"mem-8ef152d8d65a9e50","information":"Cross-Device Layout Refactoring - CSS & Foundation (2026-01-19): Fixed src/index.css global layout issues. Removed overflow:hidden from body (was breaking scroll), removed #root fixed positioning trap, replaced safe area CSS vars from 0px to env(safe-area-inset-*) for iOS notch/home bar support. Added safe area utilities: pt-safe, pb-safe-bottom, pl-safe-left, pr-safe-right. Changed overscroll-behavior: none to overscroll-behavior-y: contain. Verified index.html viewport meta has viewport-fit=cover.","created_at":"2026-01-19T19:57:23.067Z","tags":"pwa,capacitor,layout,css,safe-areas"}
{"id":"mem-919c278bcd8a194a","information":"Cross-Device Layout Refactoring - Chat Components (2026-01-19): Fixed src/pages/ChatPage.jsx by removing viewport-dependent heights (h-[75vh], max-h-[calc(100dvh-8rem)]), added safe area padding to backdrop and header. Fixed src/components/chat/ChatInput.jsx by removing position fixed bottom positioning and VisualViewport keyboard detection, added pb-[env(safe-area-inset-bottom)] for mobile. Fixed modules/county-chat/ChatRoom.jsx by removing useViewportFix hook and keyboard visibility state. Chat now works with Capacitor keyboard handling naturally.","created_at":"2026-01-19T19:57:32.276Z","tags":"pwa,capacitor,layout,chat,keyboard,safe-areas"}
{"id":"mem-995e05867ae7cd1f","information":"Test memory with patched schema for nomic-embed-text. This verifies that the swarm hivemind tools are working correctly after patching swarm-mail to use 768 dimensions.","created_at":"2026-01-16T18:36:11.021Z","tags":"test,swarm,hivemind,nomic-embed-text"}
{"id":"mem-9976a8004cc44986","information":"**Chat Milestone Animation Bug - Root Cause & Fix**\n\n**Problem:** Milestone animations replayed on page refresh and when returning to chat, despite localStorage checks.\n\n**Root Cause:** TWO separate code paths in `useChatMessages.js` were dispatching `chatMilestoneReached` events WITHOUT coordination:\n\n1. **Room load path** (lines ~208-229): Ran on every page load, dispatched event if `currentGoal !== previousMilestone` without checking if milestone was already processed\n2. **Subscription callback path** (lines ~357-410): Ran on new messages, had partial localStorage check but generated timestamps AFTER the check, causing race conditions\n\n**Key Insight:** The ref `isFirstLoadRef` resets on every mount, so navigating away and back looked like a \"first load\" each time.\n\n**Solution:** Unified deduplication using TWO localStorage keys per milestone:\n- `chat_milestone_{count}` - set when milestone is first REACHED\n- `chat_milestone_played_{count}` - set when milestone animation is PLAYED\n\nBoth code paths now follow this logic:\n1. If `milestone_played_{count}` exists → SKIP (already processed)\n2. Else if `milestone_{count}` exists → just mark as played (milestone reached but animation already handled)\n3. Else → first time: dispatch event, set both keys\n\n**Files Modified:**\n- `/home/solotitan/github/ncpulse/src/hooks/chat/useChatMessages.js` - Fixed both code paths\n- `/home/solotitan/github/ncpulse/src/components/chat/ChatHeader.jsx` - Simplified event handler and mount check\n\n**Key Pattern:** When dealing with Supabase real-time subscriptions + page navigation, use persistent localStorage state (not in-memory refs) to track one-time events across page loads and navigation cycles.","created_at":"2026-01-18T07:32:00.410Z","tags":"[\"milestone\",\"animation\",\"localstorage\",\"supabase\",\"race-condition\",\"chat\",\"react-hooks\"]"}
{"id":"mem-a8469ae64ef916aa","information":"Session handoff 2026-01-17 - Chat module completion:\n- ActivityRing component for message milestones (100, 500, 1K, 5K, 10K)\n- Chat layout fixed (BottomNav padding, input visibility)\n- Profanity filter with 4 levels: relaxed, medium, strict, paranoid\n- Settings read from Supabase chat_settings table with realtime subscription\n- Milestone events with custom event dispatch and notification support\n- All lint passes, no known issues, deployed and feature-complete","created_at":"2026-01-17T21:28:23.001Z","tags":"chat-module,profanity-filter,milestone-tracking,activity-ring,layout-fix"}
{"id":"mem-ee3a9a01a88adedd","information":"Cross-Device Layout Refactoring - Validation & Results (2026-01-19): All 48 tests passing (6 test files, 409ms duration). Build succeeds with only pre-existing React hook act() warnings (unrelated to layout changes). Rules verified: No vh units anywhere, No h-screen/min-h-screen usage, Single scroll surface using flex-1 overflow-y-auto pattern, Safe areas padded with env(), Keyboard-safe layout via Capacitor, Desktop max-width shells present, Sidebar at desktop/BottomNav at mobile, Mobile-first structure, Works with touch gestures and mouse+keyboard, No clipped UI or unreachable content.","created_at":"2026-01-19T19:57:42.451Z","tags":"pwa,capacitor,layout,validation,testing"}
{"id":"mem-efe1d8016540b649","information":"Cross-Device Layout Refactoring - Navigation (2026-01-19): Created src/components/DesktopSidebar.jsx with 256px width, fixed positioning, md:flex visibility. Updated src/components/BottomNav.jsx to use paddingBottom: env(safe-area-inset-bottom) instead of hardcoded 16px. BottomNav shows mobile only (md:hidden), DesktopSidebar shows desktop only. Updated src/App.jsx to include DesktopSidebar and add md:ml-64 to main container. Simplified Header.jsx by removing desktop nav items (kept branding/weather).","created_at":"2026-01-19T19:57:29.308Z","tags":"pwa,capacitor,layout,navigation,sidebar"}
{"id":"mem-f523346e4d6d43b4","information":"Cross-Device Layout Refactoring - Capacitor & App Shell (2026-01-19): Fixed src/lib/capacitor.js by removing body class manipulation, only sets CSS variable for keyboard height. Simplified src/lib/useViewportFix.js to remove viewport manipulation (removed root.style.height), kept only keyboard height detection. Updated capacitor.config.ts with Keyboard plugin config (resize: body, resizeOnFullScreen: true). Added StatusBar.setOverlaysWebView({ overlay: false }). Refactored src/App.jsx to shell pattern with min-h-dvh flex flex-col, added max-w-screen-xl mx-auto px-4 wrappers, fixed main with flex-1 overflow-y-auto.","created_at":"2026-01-19T19:57:26.598Z","tags":"pwa,capacitor,layout,keyboard,app-shell"}